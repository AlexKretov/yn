# Проект. Улучшение baseline-модели
## Описание задачи
Мы работаем с учебным набором данных Яндекс Недвижимости, маркетплейсе для аренды и покупки жилой и коммерческой недвижимости. Наша задача — выступить надёжным посредником между арендодателями или продавцами и потенциальными арендаторами или покупателями, 
сделав процесс сделки максимально эффективным и безопасным для обеих сторон.
## Проблема
Мы выдвинули гипотезу, что стоимость объекта недвижимости можно объективно оценить извне — это устранит разногласия между сторонами и увеличит среднемесячное количество сделок на платформе. Вы разработали базовое решение в виде модели машинного обучения, а также организовали пайплайн данных в Airflow. Менеджеры убедились, что ваша модель потенциально прибыльна, однако вместе с тем сделали вывод, что метрики модели можно улучшить. 
## Бизнес-задача
Нужно оптимизировать подход, основываясь на первоначально построенном решении и настроенном пайплайне данных. Цель — сделать процесс воспроизводимым и улучшить ключевые модельные метрики, которые влияют на бизнес-показатели компании, в частности, на увеличение количества успешных сделок. Чтобы провести большое число экспериментов и обеспечить их воспроизводимость, для начала интегрируйте MLflow.
## Задача машинного обучения
Процесс прогнозирования стоимости требует доработки. Используя методы конструирования и отбора признаков, а также применяя алгоритмы для поиска оптимальных гиперпараметров модели, постараемся достичь лучших метрик, которые влияют на точность предсказаний стоимости недвижимости 
и, как следствие, на количество успешных сделок на маркетплейсе. В процессе работы будем документировать все эксперименты, используя MLflow, — это позволит отслеживать изменения в метриках и вносимые улучшения. 
Все успешные версии моделей будут зарегистрированы в соответствующем реестре MLflow, чтобы вы могли их отслеживать, сравнивать и использовать впоследствии. Это не только систематизирует процесс разработки и оценки моделей, но и обеспечит воспроизводимость результатов. 
## Данные
Чтобы улучшить модель прогнозирования стоимости, мы будем работать с данными, подготовленными и предобработанными с помощью пайплайна в Airflow. 
На прошлом этапе мы взяли набор предоставленный Яндекс.Недвижимостью, и заменили имеющиеся там мало иноформативные координаты на название ближайшей станции метро и расстояния до неё, как критически важные факторы для квартир в Москве.

## Подготовка к работе
### Создайте виртуальную среду и установите необходимые библиотеки
В командной строке создайте папку для проекта(опционально)
*cd mle_projects/your_git_project*
# обновление локального индекса пакетов
*sudo apt-get update*
# установка расширения для виртуального пространства
*sudo apt-get install python3.10-venv*
# создание виртуального пространства
*python3.10 -m venv .venv_project_name*
# активировать виртуальное пространство
*source .venv_project_name/bin/activate*
# установить необхоидмые бибилотеки
*pip install -r requirements.txt*
### Создайте файл с окружениями .env
Ориентируйтесь на шаблон .template_emv.
Убедтесь, что S3_BUCKET_NAME=s3-student-mle-20250130-833968fcc1 - это важно для корректной работы проекты.
### Запустите ML-Flow Registry Server
 Выполните в командной строке активацию сервера:
 *sh run_mlflow_server.sh* [#Здесь находится файл с настройками сервера](https://github.com/AlexKretov/yn/blob/06abedc2dce9a72f979d40b30d7b322513b8cf61/run_mlflow_server.sh)
Теперь всё готово и можно загрузить набор данных полученных на прошлом спринте.
### Загрузка старой модели
Для загрузки модели из первого спринта необходимо запустить тетрадку 
[#вот эту тетрадку](https://github.com/AlexKretov/yn/blob/bee2f6b5bb75f0aed1330b3a15cf4694d937a242/notebooks/baseline.ipynb)
### Анализ данных
Следующий код позволяет изучить набор данных в детелях и графиках:
[#eda.ipynb](https://github.com/AlexKretov/yn/blob/8b16241554327cf3e95fd4377afd2e6462f5fc1c/notebooks/eda.ipynb)
### Генерация признаков
Для окончательной предобработки и генерации новых признаков, запускается вот эта тетрадка: 
[#fitting.ipynb](https://github.com/AlexKretov/yn/blob/8b16241554327cf3e95fd4377afd2e6462f5fc1c/notebooks/fitting.ipynb)
### Оптимизация гиперпараметров
Здесь проводится окончательная доводка и оценка модели.
[#tuning.ipynb](https://github.com/AlexKretov/yn/blob/8b16241554327cf3e95fd4377afd2e6462f5fc1c/notebooks/tuning.ipynb)

